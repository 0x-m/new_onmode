function like(e){const t=e.dataset.pid;fetch("/catalogue/product/"+t+"/like").then(t=>{200==t.status&&t.json().then(t=>{"liked"==t.status?(e.classList.add("bg-red-500"),e.classList.add("text-white")):"unliked"==t.status&&(e.classList.remove("bg-red-500"),e.classList.remove("text-white"))})})}function update_cart_badge(e){document.getElementById("cart-badge").innerText=e,console.log("cart updated...")}function addToCart(e){const t=e.dataset.pid,n=null==e.dataset.collection?"":e.dataset.collection,a=document.getElementById("product_options"),d=null==a?"":a.value,o=document.getElementsByName("csrfmiddlewaretoken")[0].value;console.log(o),e.disabled=!0,fetch("/cart/add",{method:"POST",body:new URLSearchParams({product:t,quantity:1,collection:n,options:d}),headers:{"X-CSRFToken":o,"Content-Type":"application/x-www-form-urlencoded"}}).then(t=>{200==t.status&&t.json().then(t=>{e.disabled=!1,update_cart_badge(t.cart)}),console.log(t)})}function deleteFromCart(e){const t=e.dataset.itemid,n=document.getElementById(e.dataset.total);fetch("/cart/delete/"+t).then(t=>{200==t.status&&(t.json().then(e=>{n.innerText=e.final_price,update_cart_badge(e.cart),console.log(e.cart,"cart value")}),e.parentNode.remove())})}function applyCoupon(e){const t=e.dataset.order,n=document.getElementById("coupon_code").value,a=document.getElementsByName("csrfmiddlewaretoken")[0].value,d=document.getElementById("final_price"),o=document.getElementById("delete_coupon_template"),c=document.getElementById("has_coupon");e.disabled=!0,fetch("/cart/coupon/add",{method:"POST",body:new URLSearchParams({code:n,order_id:t}),headers:{"X-CSRFToken":a,"Content-Type":"application/x-www-form-urlencoded"}}).then(t=>{200==t.status?t.json().then(t=>{d.innerText=t.final_price+"تومان",e.parentNode.parentNode.replaceChildren(o.content.cloneNode(!0)),c.innerText="دارد"}):document.getElementById("coupon_error_text").classList.remove("hidden"),e.disabled=!1})}function deleteCoupon(e){const t=e.dataset.order,n=document.getElementsByName("csrfmiddlewaretoken")[0].value,a=document.getElementById(e.dataset.final_price),d=document.getElementById("add_coupon_template"),o=document.getElementById("has_coupon");fetch("/cart/coupon/delete",{method:"POST",body:new URLSearchParams({order_id:t}),headers:{"X-CSRFToken":n,"Content-Type":"application/x-www-form-urlencoded"}}).then(t=>{200==t.status&&t.json().then(t=>{a.innerText=t.final_price+"تومان",e.parentNode.replaceChildren(d.content.cloneNode(!0)),o.innerText="ندارد"})})}function incrementQuantity(e){const t=e.dataset.itemid,n=document.getElementById(e.dataset.total),a=e.nextElementSibling;e.disabled=!0,fetch("/cart/increment/"+t).then(t=>{200==t.status&&(t.json().then(e=>{n.innerText=e.final_price,a.value=parseInt(a.value)+1,update_cart_badge(e.cart)}),e.disabled=!1)})}function decrementQuantity(e){const t=e.dataset.itemid,n=document.getElementById(e.dataset.total),a=e.previousElementSibling;e.disabled=!0,fetch("/cart/decrement/"+t).then(t=>{200==t.status&&(t.json().then(t=>{n.innerText=t.final_price,a.value=parseInt(a.value)-1,update_cart_badge(t.cart),0==a.value&&e.parentNode.parentNode.remove()}),e.disabled=!1)})}function get_cities(e){const t=e.selectedOptions[0].dataset.id;-1!=t&&(e.disabled=!0,fetch("/geo/cities/"+t).then(t=>{200==t.status?t.json().then(t=>{const n=document.createDocumentFragment(),a=document.getElementById("cities");a.innerHTML="";for(let e=0;e<t.cities.length;++e){let a=document.createElement("option");a.innerText=t.cities[e],a.value=t.cities[e],n.append(a)}a.appendChild(n),e.disabled=!1}):e.disabled=!1}))}